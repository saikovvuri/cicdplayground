trigger:
- master

stages:
 - stage: Build
   jobs:
   - job: Build   
     pool:
       vmImage: 'ubuntu-latest'
     variables:
       buildConfiguration: 'Release'
     steps:
      - script: dotnet build --configuration $(buildConfiguration)
        displayName: 'dotnet build $(buildConfiguration)'
      - task: DotNetCoreCLI@2
        inputs:
          command: 'publish'
          publishWebProjects: true
          arguments: '--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)'
      - task: PublishBuildArtifacts@1
        inputs:
          PathtoPublish: '$(Build.ArtifactStagingDirectory)'
          ArtifactName: 'drop'
          publishLocation: 'Container'
  
 - stage: Deploy
   jobs:
   - job: Deploy
     pool:
       vmImage: 'ubuntu-latest'
     steps:
      - task: AzureRmWebAppDeployment@4
        inputs:
          ConnectionType: 'AzureRM'
          azureSubscription: 'Sakovvu Azure'
          appType: 'webAppLinux'
          WebAppName: 'cicd-webapp'
          packageForLinux: '$(System.DefaultWorkingDirectory)/**/*.zip'